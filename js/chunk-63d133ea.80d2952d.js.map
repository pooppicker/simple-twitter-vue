{"version":3,"sources":["webpack:///./src/views/UserSetting.vue?2671","webpack:///./src/views/UserSetting.vue","webpack:///src/views/UserSetting.vue","webpack:///./src/views/UserSetting.vue?53db","webpack:///./src/views/UserSetting.vue?0ba0"],"names":["render","_vm","this","_c","_self","staticClass","_v","attrs","directives","name","rawName","value","userInfo","account","expression","domProps","on","$event","target","composing","$set","email","password","checkPassword","isProcessing","stopPropagation","preventDefault","handleSubmit","apply","arguments","staticRenderFns","components","NavBars","data","id","created","methods","fetchUser","Toast","icon","title","userID","params","console","computed","watch","currentUser","handler","deep","component"],"mappings":"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","file":"js/chunk-63d133ea.80d2952d.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserSetting.vue?vue&type=style&index=0&id=50f45d46&prod&lang=scss&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"container setting-content\"},[_c('div',{staticClass:\"setting\"},[_c('div',{staticClass:\"setting-navbars\"},[_c('NavBars')],1),_c('div',{staticClass:\"setting-container\"},[_c('h4',[_vm._v(\"帳戶設定\")]),_c('form',{staticClass:\"d-flex flex-column align-items-start\"},[_c('div',{staticClass:\"setting-rwb\"},[_c('div',{staticClass:\"set-input mb-2\"},[_c('label',{staticClass:\"setting-label\",attrs:{\"for\":\"account\"}},[_vm._v(\"帳號\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.userInfo.account),expression:\"userInfo.account\"}],staticClass:\"setting-input\",attrs:{\"name\":\"account\",\"id\":\"account\",\"type\":\"text\",\"autofocus\":\"\"},domProps:{\"value\":(_vm.userInfo.account)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.userInfo, \"account\", $event.target.value)}}})]),_c('div',{staticClass:\"set-input mb-2\"},[_c('label',{staticClass:\"setting-label\",attrs:{\"for\":\"name\"}},[_vm._v(\"名稱\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.userInfo.name),expression:\"userInfo.name\"}],staticClass:\"setting-input\",attrs:{\"id\":\"name\",\"name\":\"name\",\"type\":\"text\",\"autofocus\":\"\"},domProps:{\"value\":(_vm.userInfo.name)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.userInfo, \"name\", $event.target.value)}}})]),_c('div',{staticClass:\"set-input mb-2\"},[_c('label',{staticClass:\"setting-label\",attrs:{\"for\":\"email\"}},[_vm._v(\"Email\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.userInfo.email),expression:\"userInfo.email\"}],staticClass:\"setting-input\",attrs:{\"name\":\"email\",\"id\":\"email\",\"type\":\"email\",\"autofocus\":\"\"},domProps:{\"value\":(_vm.userInfo.email)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.userInfo, \"email\", $event.target.value)}}})]),_c('div',{staticClass:\"set-input mb-2\"},[_c('label',{staticClass:\"setting-label\",attrs:{\"for\":\"password\"}},[_vm._v(\"密碼\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.userInfo.password),expression:\"userInfo.password\"}],staticClass:\"setting-input\",attrs:{\"id\":\"password\",\"name\":\"password\",\"type\":\"password\",\"autocomplete\":\"new-password\"},domProps:{\"value\":(_vm.userInfo.password)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.userInfo, \"password\", $event.target.value)}}})]),_c('div',{staticClass:\"set-input mb-2\"},[_c('label',{staticClass:\"setting-label\",attrs:{\"for\":\"checkPassword\"}},[_vm._v(\"密碼確認\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.userInfo.checkPassword),expression:\"userInfo.checkPassword\"}],staticClass:\"setting-input\",attrs:{\"id\":\"checkPassword\",\"name\":\"checkPassword\",\"type\":\"password\",\"autocomplete\":\"new-password\"},domProps:{\"value\":(_vm.userInfo.checkPassword)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.userInfo, \"checkPassword\", $event.target.value)}}})])]),_c('div',{staticClass:\"set-btn\"},[_c('button',{staticClass:\"setting-btn mb-3\",attrs:{\"type\":\"submit\",\"disabled\":_vm.isProcessing},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.handleSubmit.apply(null, arguments)}}},[_vm._v(\"儲存\")])])])])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"container setting-content\">\n    <div class=\"setting\">\n      <div class=\"setting-navbars\">\n        <!--navbar-->\n        <NavBars />\n      </div>\n      <div class=\"setting-container\">\n     \n        <h4>帳戶設定</h4>\n        <form\n          class=\"d-flex flex-column align-items-start\"\n          \n        >\n          <div class=\"setting-rwb\">\n            <div class=\"set-input mb-2\">\n              <label class=\"setting-label\" for=\"account\">帳號</label>\n              <input\n                v-model=\"userInfo.account\"\n                name=\"account\"\n                class=\"setting-input\"\n                id=\"account\"\n                type=\"text\"\n                autofocus\n              />\n            </div>\n\n            <div class=\"set-input mb-2\">\n              <label class=\"setting-label\" for=\"name\">名稱</label>\n              <input\n                v-model=\"userInfo.name\"\n                class=\"setting-input\"\n                id=\"name\"\n                name=\"name\"\n                type=\"text\"\n                autofocus\n              />\n            </div>\n\n            <div class=\"set-input mb-2\">\n              <label class=\"setting-label\" for=\"email\">Email</label>\n              <input\n                v-model=\"userInfo.email\"\n                name=\"email\"\n                class=\"setting-input\"\n                id=\"email\"\n                type=\"email\"\n                autofocus\n              />\n            </div>\n\n            <div class=\"set-input mb-2\">\n              <label class=\"setting-label\" for=\"password\">密碼</label>\n              <input\n                v-model=\"userInfo.password\"\n                class=\"setting-input\"\n                id=\"password\"\n                name=\"password\"\n                type=\"password\"\n                autocomplete=\"new-password\"\n              />\n            </div>\n\n            <div class=\"set-input mb-2\">\n              <label class=\"setting-label\" for=\"checkPassword\">密碼確認</label>\n              <input\n                v-model=\"userInfo.checkPassword\"\n                class=\"setting-input\"\n                id=\"checkPassword\"\n                name=\"checkPassword\"\n                type=\"password\"\n                autocomplete=\"new-password\"\n              />\n            </div>\n          </div>\n\n          <div class=\"set-btn\">\n            <button type=\"submit\" class=\"setting-btn mb-3\" @click.stop.prevent=\"handleSubmit\" :disabled=\"isProcessing\">儲存</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport NavBars from \"./../components/NavBars.vue\";\nimport UserAPI from \"./../apis/users\";\nimport { Toast } from \"./../utils/helpers\";\nimport { mapState } from \"vuex\"; //新增這裡\n\nexport default {\n  components: {\n    NavBars,\n  },\n\n  data() {\n    return {\n      userInfo: {\n        id: -1,\n        account: \"\",\n        name: \"\",\n        email: \"\",\n        password: \"\",\n        checkPassword: \"\",\n      },\n      isProcessing: false,\n    };\n  },\n\n  created() {\n    // const { id } = this.$route.params;\n    this.fetchUser();\n    // console.log(this.currentUser);\n  },\n  methods: {\n    //這裡我們把原本的api拿資料fetch過程，改成拿vuex的資料fetch\n\n    fetchUser() {\n      const { id, account, name, email } = this.currentUser;\n\n      this.userInfo = {\n        ...this.userInfo,\n        id,\n        account,\n        name,\n        email,\n      };\n      this.isProcessing = false;\n    },\n\n    async handleSubmit() {\n      try {\n        this.isProcessing = true;\n        const { id, account, name, email, password, checkPassword} =this.userInfo;\n        \n        //確認沒缺格\n        if (!account || !name || !email) {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"帳號、姓名與電子信箱為必填\",\n          });\n          this.isProcessing = false;\n          return;\n        }\n\n        //確認密碼確認跟密碼一樣\n        if (password !== checkPassword) {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"密碼與密碼確認內容須相同！\",\n          });\n          this.userInfo.checkPassword = \"\";\n          this.isProcessing = false;\n          return;\n        }\n\n        //確認帳號格式(不能有空格)\n\n        if (account.indexOf(\" \") !== -1) {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"帳號不能有空格\",\n          });\n          this.isProcessing = false;\n          return;\n        }\n\n        //確認名字格式(不能有空格)\n\n        if (name.length > 50) {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"名稱不能多於50字！\",\n          });\n          this.isProcessing = false;\n          return;\n        }\n\n        //確認email格式\n        if (\n          email.indexOf(\"@\") === -1 ||\n          email.indexOf(\".com\") === -1\n        ) {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"email須含有@與.com等字元\",\n          });\n          this.isProcessing = false;\n          return;\n        }\n\n        //console.log(formData);\n\n        const { data } = await UserAPI.editUserAccount({\n          userID: id,\n          account,\n          name,\n          email,\n          password,\n          checkPassword,\n        });\n        if (data.status === \"error\") {\n          throw new Error(data.message);\n        }\n        Toast.fire({\n          icon: \"success\",\n          title: \"成功更新資料\",\n        });\n\n        this.$store.dispatch(\"fetchCurrentUser\");\n        this.$router.push({ name: \"User\", params: { id: this.userInfo.id } });\n        this.isProcessing = false;\n      } catch (error) {\n        console.log(error);\n        this.isProcessing = false;\n        if (error.message === \"This account name has been registered\") {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"帳號已重覆註冊\",\n          });\n        } else if (error.message === \"This email has been registered\") {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"Email已重覆註冊\",\n          });\n        } else {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"更新失敗，請稍後再試！\",\n          });\n        }\n      }\n    },\n  },\n  //新增這裡，把vuex的資料拿出來~等於現在已經有一個data() {return{currentUser:{...}}的資料囉 }\n  computed: {\n    ...mapState([\"currentUser\"]),\n  },\n  //新增這裡！這裏特別注意！因為重新整理之後，路由那裡會再去叫一次currentUser的api，這時候會有時間差，可能畫面渲染好，currentUser才回來，所以要再監聽一次看資料有沒有變化\n  watch: {\n    currentUser: {\n      handler: function () {\n        this.fetchUser();\n      },\n      deep: true,\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n@import \"../assets/scss/efficientSetting.scss\";\n.setting-content {\n  height: 100vh;\n  width: 100vw;\n  .setting {\n    @extend %views-grid;\n    grid-template-areas: \"nav sets sets\";\n  }\n  .setting-navbars {\n    grid-area: nav;\n  }\n  .setting-container {\n    grid-area: sets;\n    border-left: 1px solid #e6ecf0;\n    margin-left: 1.5em;\n    h4 {\n      // outline: 1px solid black;\n      border-bottom: 1px solid #e6ecf0;\n      font-size: 19px;\n      padding: 0.7rem;\n    }\n    .set-input {\n      @extend %input-bottom;\n      background-color: #f5f8fa;\n      width: 642px;\n      height: 52px;\n      margin: 1rem 0 1rem 0.7rem;\n      border-radius: 4px 4px 0px 0px;\n    }\n    .setting-label {\n      font-size: 13px;\n      color: #657786;\n      display: block;\n    }\n    .setting-input {\n      background-color: #f5f8fa;\n      font-size: 15px;\n      margin-bottom: 0.5rem;\n      width: 100%;\n    }\n    .set-btn {\n      min-width: 642px;\n      display: flex;\n      justify-content: end;\n      .setting-btn {\n        width: 90px;\n        height: 36px;\n        color: #ffffff;\n        font-weight: 700;\n        background-color: #ff6600;\n        border-radius: 50px;\n      }\n    }\n  }\n}\n//手機板\n@media screen and (max-width: 768px) {\n  .setting-content {\n    .setting {\n      grid-template-columns: 0fr 1fr 0fr;\n    }\n\n    .setting-container {\n      border-left: none;\n      margin-left: 0;\n      .setting-rwb {\n        width: 100%;\n        padding: 0 1em;\n      }\n      h4 {\n        // outline: 1px solid black;\n        margin-top: 3em;\n        width: 100vw;\n        background-color: $color-orange;\n        border-bottom: 1px solid #e6ecf0;\n        font-size: 19px;\n        padding: 0.7rem;\n        color: white;\n      }\n      .set-input {\n        width: 100%;\n        margin: 1rem 0 1rem 0rem;\n      }\n      .set-btn {\n        min-width: 100%;\n        padding-right: 1em;\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserSetting.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserSetting.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserSetting.vue?vue&type=template&id=50f45d46&\"\nimport script from \"./UserSetting.vue?vue&type=script&lang=js&\"\nexport * from \"./UserSetting.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserSetting.vue?vue&type=style&index=0&id=50f45d46&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}